---
title: "brain_development"
output: html_document
date: "`r Sys.Date()`"
---

## data information:

Lab: Kriegstein Lab

Institution: University of California, San Francisco

Publication: [Velmeshev et al. Science. 2023.](https://www.science.org/doi/10.1126/science.adf0834)

PubMed Abstract: [37824647](https://pubmed.ncbi.nlm.nih.gov/37824647/)

Publication Fulltext: [10.1126/science.adf0834](https://www.science.org/doi/10.1126/science.adf0834)

Submitted by: Dmitry Velmeshev ([dmitry.velmeshev\@duke.edu](mailto:dmitry.velmeshev@duke.edu){.email}) (2023-08-30), Version 2

Scanpy h5ad: [velmeshev_snRNA_seq.h5ad](https://cells.ucsc.edu/pre-postnatal-cortex/all/rna/velmeshev_snRNA_seq.h5ad)

Direct link to this collection for manuscripts: <https://pre-postnatal-cortex.cells.ucsc.edu>

## data link:

snrna-seq: <https://cells.ucsc.edu/?ds=pre-postnatal-cortex+all+rna>

snatac-seq: <https://cells.ucsc.edu/?ds=pre-postnatal-cortex+all+atac>

gene activity level: <https://cells.ucsc.edu/?ds=pre-postnatal-cortex+all+ga>

h5ad and Seurat (V5) object: <https://cellxgene.cziscience.com/collections/bacccb91-066d-4453-b70e-59de0b4598cd>

## code link

zenodo: <https://zenodo.org/records/7245297>

## run

```{r load_libraries, message=FALSE}
# library(Seurat)
```

```{r load_snRNA_data}
# rna_matrix <- Seurat::Read10X(
#   data.dir = "../../inferCSN_data/science_data/rna",
#   gene.column = 1)
# saveRDS(
#   rna_matrix,
#   "../../inferCSN_data/science_data/rna_output/rna_matrix.rds")
rna_matrix <- readRDS("../../inferCSN_data/science_data/rna_output/rna_matrix.rds")

rna_metadata <- read.table(
  file = "../../inferCSN_data/science_data/rna_metadata/meta.tsv",
  sep = "\t",
  header = TRUE,
  row.names = 1)

rna_umap <- read.table(
  file = "../../inferCSN_data/science_data/rna_metadata/UMAP.coords.tsv.gz",
  sep = "\t",
  row.names = 1)
```

```{r load_snATAC_data}
# atac_matrix <- Seurat::Read10X(
#   data.dir = "../../inferCSN_data/science_data/rna",
#   gene.column = 1)
# saveRDS(
#   atac_matrix,
#   "../../inferCSN_data/science_data/atac_output/atac_matrix.rds")
atac_matrix <- readRDS("../../inferCSN_data/science_data/atac_output/atac_matrix.rds")

atac_metadata <- read.table(
  file = "../../inferCSN_data/science_data/rna_metadata/meta.tsv",
  sep = "\t",
  header = TRUE,
  row.names = 1)

atac_umap <- read.table(
  file = "../../inferCSN_data/science_data/rna_metadata/UMAP.coords.tsv.gz",
  sep = "\t",
  row.names = 1)
```


```{r download_from_cellxgene(5647MB), message=FALSE}
if (!file.exists("../../inferCSN_data/science_data/seurat_v5.rds")) {
  options(timeout = 3600)
  download.file(
    "https://datasets.cellxgene.cziscience.com/50671879-9cc9-4a91-944a-6dbcf1c67173.rds",
    "../../inferCSN_data/science_data/seurat_v5.rds")
}
seurat_object <- readRDS("../../inferCSN_data/science_data/seurat_v5.rds")
```

```{r}
Seurat::UMAPPlot(seurat_object)
```
